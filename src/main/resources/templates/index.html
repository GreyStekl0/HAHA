<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H.A.H.A. - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∞–Ω–µ–∫–¥–æ—Ç–æ–≤</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<div class="logo-container">
    <div class="logo">H.A.H.A.</div>
    <div class="logo-full">Humor Analysis via Human-like AI</div>
</div>

<div class="container">
    <h1><span class="emoji">üòÇ</span>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∞–Ω–µ–∫–¥–æ—Ç–æ–≤<span class="emoji">ü§£</span></h1>

    <div class="input-section">
        <label class="input-label">–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π –∞–Ω–µ–∫–¥–æ—Ç:</label>
        <textarea class="textarea-field" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ —Å–º–µ—à–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –∏–ª–∏ –∞–Ω–µ–∫–¥–æ—Ç..."></textarea>
        <button class="submit-btn">–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <div class="progress-section" id="progressSection">
        <div class="progress-container">
            <div class="progress-label">
                <span><span class="emoji">üòÜ</span>–°–º–µ—à–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä</span>
                <span class="progress-percent-1">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill progress-fill-1" id="progressFill1"></div>
            </div>
            <div class="progress-description description-1">
                –ò–∑–º–µ—Ä—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å —é–º–æ—Ä–∞ –æ—Ç "–ù–µ —Å–º–µ—à–Ω–æ" –¥–æ "–ú–æ–∂–Ω–æ –ø–∞–¥–∞—Ç—å —Å–æ —Å—Ç—É–ª–∞ –æ—Ç —Å–º–µ—Ö–∞"
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-label">
                <span><span class="emoji">üß†</span>–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å</span>
                <span class="progress-percent-2">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill progress-fill-2" id="progressFill2"></div>
            </div>
            <div class="progress-description description-2">
                –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–≤–µ–∂–∞—è –∏–¥–µ—è, –æ—Ç "–ë–æ—Ä–æ–¥–∞—Ç—ã–π –∞–Ω–µ–∫–¥–æ—Ç" –¥–æ "–ù–∏–∫–æ–≥–¥–∞ —Ç–∞–∫–æ–≥–æ –Ω–µ —Å–ª—ã—à–∞–ª!"
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-label">
                <span><span class="emoji">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å</span>
                <span class="progress-percent-3">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill progress-fill-3" id="progressFill3"></div>
            </div>
            <div class="progress-description description-3">
                –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –ª—é–¥–µ–π –æ—Ü–µ–Ω—è—Ç —à—É—Ç–∫—É, –æ—Ç "–¢–æ–ª—å–∫–æ –¥–ª—è —É–∑–∫–æ–≥–æ –∫—Ä—É–≥–∞" –¥–æ "–†–∞—Å—Å–º–µ—à–∏—Ç –∫–∞–∂–¥–æ–≥–æ"
            </div>
        </div>

        <div class="summary-section" id="summarySection">
            <div class="summary-title"><span class="emoji">üèÜ</span>–ò—Ç–æ–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑<span class="emoji">üèÜ</span></div>
            <div class="summary-text" id="summaryText"></div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const submitBtn = document.querySelector('.submit-btn');
        const inputField = document.querySelector('.textarea-field');
        const progressSection = document.querySelector('.progress-section');
        const progressFill1 = document.getElementById('progressFill1');
        const progressFill2 = document.getElementById('progressFill2');
        const progressFill3 = document.getElementById('progressFill3');
        const progressPercent1 = document.querySelector('.progress-percent-1');
        const progressPercent2 = document.querySelector('.progress-percent-2');
        const progressPercent3 = document.querySelector('.progress-percent-3');
        const summarySection = document.getElementById('summarySection');
        const summaryText = document.getElementById('summaryText');

        // –ó–∞–±–∞–≤–Ω—ã–µ —Ñ—Ä–∞–∑—ã –¥–ª—è –ø—É—Å—Ç–æ–≥–æ –≤–≤–æ–¥–∞
        const emptyInputMessages = [
            "–ë–µ–∑ –∞–Ω–µ–∫–¥–æ—Ç–∞ —è –Ω–µ –º–æ–≥—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ —Å–º–µ—à–Ω–æ! ü§î",
            "–î–∞–∂–µ –ò–ò –Ω—É–∂–µ–Ω –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å! üßê",
            "–¢–∏—à–∏–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–æ–ª–æ—Ç–æ–º, –Ω–æ –Ω–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –∞–Ω–µ–∫–¥–æ—Ç–æ–≤! üòÖ",
            "–ü—É—Å—Ç–∞—è —à—É—Ç–∫–∞ = –Ω—É–ª–µ–≤–∞—è –æ—Ü–µ–Ω–∫–∞. –õ–æ–≥–∏—á–Ω–æ, –ø—Ä–∞–≤–¥–∞? ü§∑‚Äç‚ôÇÔ∏è",
            "–î–∞–∂–µ —Å–∞–º—ã–π –∫–æ—Ä–æ—Ç–∫–∏–π –∞–Ω–µ–∫–¥–æ—Ç —Å–æ—Å—Ç–æ–∏—Ç —Ö–æ—Ç—è –±—ã –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–≤! üìù"
        ];

        // –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –∞–Ω–µ–∫–¥–æ—Ç–∞
        function analyzeJoke() {
            if (inputField.value.trim() === '') {
                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—É—Å—Ç–æ–≥–æ –≤–≤–æ–¥–∞
                const randomMessage = emptyInputMessages[Math.floor(Math.random() * emptyInputMessages.length)];
                alert(randomMessage);
                return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
            progressSection.style.display = 'block';
            summarySection.style.display = 'none';

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
            progressFill1.style.width = '0%';
            progressFill2.style.width = '0%';
            progressFill3.style.width = '0%';
            progressPercent1.textContent = '0%';
            progressPercent2.textContent = '0%';
            progressPercent3.textContent = '0%';

            // –ü–æ–ª—É—á–∞–µ–º –∞–Ω–µ–∫–¥–æ—Ç –∏–∑ –ø–æ–ª—è –≤–≤–æ–¥–∞
            const joke = inputField.value.trim();

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ API
            fetch(`/api/evaluate?joke=${encodeURIComponent(joke)}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞');
                    }
                    return response.json();
                })
                .then(data => {
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ—Ü–µ–Ω–∫–∏ –æ—Ç 0-10 –∫ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º (0-100%)
                    const funnyFactor = data.funniness * 10;
                    const originalityFactor = (10 - data.cringiness) * 10; // –ò–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫—Ä–∏–Ω–∂–æ–≤–æ—Å—Ç—å –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å
                    const universalityFactor = data.decency * 10;

                    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ (—Å–º–µ—à–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä)
                    setTimeout(function () {
                        progressFill1.style.width = funnyFactor + '%';
                        progressPercent1.textContent = funnyFactor + '%';
                    }, 500);

                    // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
                    setTimeout(function () {
                        progressFill2.style.width = originalityFactor + '%';
                        progressPercent2.textContent = originalityFactor + '%';
                    }, 1500);

                    // –ê–Ω–∏–º–∞—Ü–∏—è —Ç—Ä–µ—Ç—å–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å)
                    setTimeout(function () {
                        progressFill3.style.width = universalityFactor + '%';
                        progressPercent3.textContent = universalityFactor + '%';

                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
                        setTimeout(function () {
                            // –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞
                            const overallScore = Math.floor((funnyFactor + originalityFactor + universalityFactor) / 3);
                            let rating;

                            if (overallScore < 40) {
                                rating = "üòê –ù—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å";
                            } else if (overallScore < 60) {
                                rating = "üôÇ –ù–æ—Ä–º–∞–ª—å–Ω–æ";
                            } else if (overallScore < 80) {
                                rating = "üòÑ –•–æ—Ä–æ—à–æ!";
                            } else {
                                rating = "ü§£ –í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ!";
                            }

                            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç API
                            summaryText.innerHTML = `<strong>${rating}</strong> ‚Äî ${data.evaluation} <br><br>–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: <strong>${overallScore}%</strong>`;
                            summarySection.style.display = 'block';

                            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–æ–ª–ª –∫ –∏—Ç–æ–≥–æ–≤–æ–º—É –∞–Ω–∞–ª–∏–∑—É
                            summarySection.scrollIntoView({behavior: 'smooth', block: 'start'});
                        }, 500);
                    }, 2500);
                })
                .catch(error => {
                    alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞: ' + error.message);
                    console.error('–û—à–∏–±–∫–∞:', error);
                });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏
        submitBtn.addEventListener('click', analyzeJoke);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        inputField.addEventListener('keydown', function (event) {
            // –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç Enter –±–µ–∑ Shift
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault(); // –û—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏)
                analyzeJoke(); // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∞–Ω–∞–ª–∏–∑–∞
            }
        });
    });
</script>
</body>
</html>